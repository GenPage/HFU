#	Example:
#
#	example_effect = {
#		add_political_power = 66
#		add_popularity = {
#			ideology = fascism
#			popularity = 0.33
#		}
#	}
#
#
#	In a script file:
#
#	effect = {
#		example_effect = yes
#	}
#

#####################################
### emergency_factory_conversion ####
#####################################

#This is going to give misleading and ugly tooltips. Making it nice will take effort. TODO_WTT_CD make nice or ignore and remove comment. Easiest solution is just making a custom tooltip that says "5 civilian factories will be converted to military factories" and ignore telling the player the states where it will happen.

replace_civ_with_arms_factories = {

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}

#Country scope
ROOT_inherit_current_scope_wars_effect = {
	custom_effect_tooltip = ROOT_inherit_current_scope_wars_effect
	hidden_effect = {
		every_country = {
			limit = {
				has_defensive_war_with = PREV
			}
			ROOT = { declare_war_on = { target = PREV type = annex_everything } }
		}
		every_country = {
			limit = {
				has_offensive_war_with = PREV
			}
			declare_war_on = { target = ROOT type = annex_everything }
		}
	}
}

build_random_mil_factory = {
	random_owned_state = {
		limit = { is_valid_state_for_arms_factory = yes }
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}

build_2_random_mil_factory = {
	random_owned_state = {
		limit = { is_valid_state_for_arms_factory = yes }
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = arms_factory
			level = 2
			instant_build = yes
		}
	}
}

build_random_civ_factory = {
	random_owned_state = {
		limit = { is_valid_state_for_civilian_factory = yes }
		add_extra_state_shared_building_slots = 1
		add_building_construction = {
			type = industrial_complex
			level = 1
			instant_build = yes
		}
	}
}

build_2_random_civ_factory = {
	random_owned_state = {
		limit = { is_valid_state_for_civilian_factory = yes }
		add_extra_state_shared_building_slots = 2
		add_building_construction = {
			type = industrial_complex
			level = 2
			instant_build = yes
		}
	}
}

get_random_temp_variable = {
	set_temp_variable = { temp = random }
	multiply_temp_variable = { temp = 100 }
	round_variable = temp
}

increase_mobalisation_law = {
	if = {
		limit = { has_idea = civilian_economy }
		add_ideas = low_economic_mobilisation
	}
	else_if = {
		limit = { has_idea = low_economic_mobilisation }
		add_ideas = partial_economic_mobilisation
	}
	else_if = {
		limit = { has_idea = partial_economic_mobilisation }
		add_ideas = war_economy
	}
	else_if = {
		limit = { has_idea = war_economy }
		add_ideas = tot_economic_mobilisation
	}
	else = {
		random_owned_state = {
			limit = { is_fully_controlled_by = ITZ }
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
			add_extra_state_shared_building_slots = 1
		}
		random_owned_state = {
			limit = { is_fully_controlled_by = ITZ }
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
			add_extra_state_shared_building_slots = 1
		}
	}
}

increase_conscription_law = {
	if = {
		limit = { has_idea = disarmed_nation }
		add_ideas = volunteer_only
	}
	else_if = {
		limit = { has_idea = volunteer_only }
		add_ideas = limited_conscription
	}
	else_if = {
		limit = { has_idea = limited_conscription }
		add_ideas = extensive_conscription
	}
	else_if = {
		limit = { has_idea = extensive_conscription }
		add_ideas = service_by_requirement
	}
	else_if = {
		limit = { has_idea = service_by_requirement }
		add_ideas = all_adults_serve
	}
	else_if = {
		limit = { has_idea = all_adults_serve }
		add_ideas = scraping_the_barrel
	}
	else = {
		add_manpower = 20000
	}
}

build_random_dockyard = {
	random_owned_state = {
		limit = { is_valid_state_for_dockyard = yes }
		add_extra_state_shared_building_slots =1
		add_building_construction = {
			type = dockyard
			level = 1
			instant_build = yes
		}
	}
}

add_ai_alliance_strat = {
	add_ai_strategy = {
		type = alliance
		id = var:alliance_target
		value = 100
	}
	var:alliance_target = {
		add_ai_strategy = {
			type = alliance
			id = PREV
			value = 100
		}
	}
}

give_next_level_of_weapon_equipment = {
	if = {
		limit = {
			has_tech = ballistic_weaponry_tech_1
			NOT = {
				has_tech = melee_weaponry_tech_2
			}
		}
		if = {
			limit = {
				has_tech = standard_weaponry_tech
				NOT = {
					has_tech = ballistic_weaponry_tech_1
				}
			}
			set_technology = {
				ballistic_weaponry_tech_1 = 1
			}
		}
		else_if = {
			limit = {
				has_tech = ballistic_weaponry_tech_1
			}
			if = {
				limit = {
					NOT = {
						has_tech = warrior_equipment
					}
					has_tech = energy_weaponry_tech_1
				}
				if = {
					limit = {
						has_tech = energy_weaponry_tech_1
						NOT = {
							has_tech = energy_weaponry_tech_2
						}
					}
					set_technology = {
						energy_weaponry_tech_2 = 1
					}
				}
				else_if = {
					limit = {
						has_tech = energy_weaponry_tech_2
						NOT = {
							has_tech = overcharged_ammunition
						}
					}
					set_technology = {
						overcharged_ammunition = 1
					}
				}
				else_if = {
					limit = {
						has_tech = overcharged_ammunition
						NOT = {
							has_tech = energy_weaponry_tech_3
						}
					}
					set_technology = {
						energy_weaponry_tech_3 = 1
					}
				}
				else_if = {
					limit = {
						has_tech = energy_weaponry_tech_3
						NOT = {
							has_tech = custom_built_capacitors
						}
					}
					set_technology = {
						custom_built_capacitors = 1
					}
				}
				else_if = {
					limit = {
						has_tech = custom_built_capacitors
						NOT = {
							has_tech = energy_weaponry_tech_4
						}
					}
					set_technology = {
						energy_weaponry_tech_4 = 1
					}
				}
			}
			else_if = {
				limit = {
					NOT = {
						has_tech = energy_weaponry_tech_1
					}
					has_tech = warrior_equipment
				}
				if = {
					limit = {
						has_tech = warrior_equipment
						NOT = {
							has_tech = ballistic_weaponry_tech_2
						}
					}
					set_technology = {
						ballistic_weaponry_tech_2 = 1
					}
				}
				else_if = {
					limit = {
						has_tech = ballistic_weaponry_tech_2
						NOT = {
							has_tech = basic_infantry_equipment
						}
					}
					set_technology = {
						basic_infantry_equipment = 1
					}
				}
				else_if = {
					limit = {
						has_tech = basic_infantry_equipment
						NOT = {
							has_tech = ballistic_weaponry_tech_3
						}
					}
					set_technology = {
						ballistic_weaponry_tech_3 = 1
					}
				}
			}
		}
	}
	else_if = {
		limit = {
			has_tech = melee_weaponry_tech_2
			NOT = {
				has_tech = ballistic_weaponry_tech_1
			}
		}
		if = {
			limit = {
				has_tech = melee_weaponry_tech_2
				NOT = {
					has_tech = melee_weaponry_tech_3
				}
			}
			set_technology = {
				melee_weaponry_tech_3 = 1
			}
		}
		else_if = {
			limit = {
				has_tech = melee_weaponry_tech_3
				NOT = {
					has_tech = melee_weaponry_tech_4
				}
			}
			set_technology = {
				melee_weaponry_tech_4 = 1
			}
		}
	}
}
