@MAX_INT = 2147483
@BASE_COST = 25
@STATE_POP_DIVISOR = 0.15
@CORED_POP_DIVISOR = 1
@DISTANCE_DIVISOR = 5
@CLAIM_MULTIPLIER = 0.75
#add_core_visibility_trigger = yes trigger bearbeiten
#add_core_tlaloc_visibility_trigger = yes
scripted_gui = {
	fallout_topbar_toolbar_window = {
		context_type = player_context

		window_name = "fallout_topbar_toolbar_window"
		parent_window_token = top_bar

		visible = {
			is_ai = no
		}

		effects = {
			drop_down_button_click = {
				clear_array = fallout_topbar_toolbar_list_array
				if = {
					limit = {
						has_variable = show_fallout_topbar_toolbar_list_window
					}
					clear_variable = show_fallout_topbar_toolbar_list_window
				}
				else = {
					set_variable = { show_fallout_topbar_toolbar_list_window = 1 }
					# populate list with buttons
					if = {
						limit = {
							OR = {
								add_core_visibility_trigger = yes
								add_core_tlaloc_visibility_trigger = yes
							}
						}
						add_to_array = { fallout_topbar_toolbar_list_array = 1 }
					}
				}
			}
		}

		triggers = {
			drop_down_button_click_enabled = {
				OR = {
					add_core_visibility_trigger = yes
					add_core_tlaloc_visibility_trigger = yes
				}
			}
		}
	}

	fallout_topbar_toolbar_list_window = {
		context_type = player_context

		window_name = "fallout_topbar_toolbar_list_window"
		parent_window_token = top_bar

		visible = {
			check_variable = { show_fallout_topbar_toolbar_list_window > 0 }
		}

		effects = {
			tab_button_click = {
				# Coring List Window
				if = {
					limit = {
						check_variable = { v = 1 }
					}
					clear_array = uncored_states_array
					if = {
						limit = {
							has_variable = show_fallout_coring_tab_window
						}
						clear_variable = show_fallout_coring_tab_window
					}
					else = {
						set_variable = { show_fallout_coring_tab_window = 1 }
						if = {
							limit = {
								any_country = {
									is_in_faction_with = ROOT 
									NOT = { is_in_array = { ROOT.faction_members_array = THIS.id } }
								}
							}
							every_country = {
								limit = {
									 is_in_faction_with = ROOT 
									NOT = { is_in_array = { ROOT.faction_members_array = THIS.id } }
								}
								add_to_array = { ROOT.faction_members_array = THIS.id }
							}
						}
					}
				}

				clear_variable = show_fallout_topbar_toolbar_list_window
				clear_array = fallout_topbar_toolbar_list_array
			}
		}

		triggers = {
			tab_number_visible = {
				is_ai = no
				check_variable = { v = 1 }
				set_temp_variable = { coring_tab_number = 0 }
				if = {
					limit = {
						add_core_visibility_trigger = yes
					}
					all_owned_state = {
						if = {
							limit = {
								NOT = { is_core_of = ROOT }
								add_core_trigger = yes
							}
							add_to_temp_variable = { coring_tab_number = 1 }
						}
					}
				}
				else_if = {
					limit = {
						add_core_tlaloc_visibility_trigger = yes
					}
					all_owned_state = {
						if = {
							limit = {
								NOT = { is_core_of = ROOT }
								add_core_tlaloc_trigger = yes
							}
							add_to_temp_variable = { coring_tab_number = 1 }
						}
					}
				}
				check_variable = { coring_tab_number > 0 }
			}
		}

		properties = {
			tab_button = {
				image = "[This.GetToolbarTabButtonIcon]"
			}
		}

		dynamic_lists = {
			fallout_topbar_toolbar_list_gridbox = {
				array = fallout_topbar_toolbar_list_array
				entry_container = fallout_topbar_toolbar_list_entry
			}
		}
	}
}